> 이 포스트는 [감자](https://www.inflearn.com/course/%EA%B7%B8%EB%A6%BC%EC%9C%BC%EB%A1%9C-%EC%89%BD%EA%B2%8C-%EB%B0%B0%EC%9A%B0%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC# '감자')님의 강의를 참조하여 작성하였습니다.

## 네트워크 계층

스위치끼리 연결되어 커진 브로드캐스트 도메인은 많은 트래픽이 발생하기 때문에 어떻게든 브로드캐스트 도메인을 나눠줘야 할 것 같습니다. 여기서 어떤 장치를 만들어 브로드캐스트 도메인을 나눴다고 가정하자. 그러면 우리랑 전혀 상관이 없는 미국에 사는 짱구와 철수가 통신하더라도 우리는 브로드캐스트 메세지가 전달되지 않을 것이다. 그러면 쓸데없는 트래픽이 오지 않을 것이다. 여기서 우리가 짱구와 통신을 하고 싶다면 어떻게 될까? 우리가 보내려는 데이터에 출발지 MAC주소는 우리의 MAC주소, 목적지 MAC주소는 짱구의 MAC주소를 적고 스위치로 전송할 것이다. 하지만 스위치는 자신의 MAC주소 테이블에 해당 메세지의 목적지 MAC주소와 일치하는 주소가 없으므로 Flooding을 한다. 그럼 중간에 블랙박스로 데이터가 전송되지만 블랙박스는 자신에게 온 데이터가 아니므로 버릴 것이다. 이런 상황에서는 우리와 짱구는 영영 통신하지 못한다. 이렇게 LAN영역에서 다른 LAN영역으로 넘어가게 되면 기존에 사용하던 출발지, 목적지 MAC주소만으로는 다른 LAN영역에 있는 컴퓨터에 전송하기 힘들다.

이런 문제가 발생하니 사람들은 물리적인 주소인 MAC주소 외에 논리적인 주소를 추가로 만들어야겠다는 생각을 하게 된다. 그리고 브로드캐스트 도메인을 나누는 어떤 장치에 라우터라는 이름을 붙이고 IP주소를 활용해 LAN영역 사이를 문제없이 통신하도록 만들었다. IP주소 덕분에 다른 네트워크에 있는 컴퓨터를 정확하게 나타낼 수 있고 라우터가 복잡한 네트워크에서 경로를 지정할 수 있다. 이전 상황에서 논리적인 주소인 IP주소를 추가하여 통신하는 모습을 보자. 먼저 우리의 PC와 라우터, 짱구의 PC에는 MAC주소뿐만 아니라 IP주소까지 할당된다. 라우터는 여러개의 포트가 있으므로 포트마다 MAC주소와 IP주소가 할당된다. 우리는 짱구에게 데이터를 전송하기 위해서 출발지 IP주소엔 우리의 IP주소, 목적지 IP주소엔 짱구의 IP주소를 적고 출발지 MAC주소엔 우리의 MAC주소, 목적지 MAC주소엔 짱구의 MAC주소가 아닌 라우터의 MAC주소를 적고 전송한다. 그러면 스위치를 통해 라우터로 전달된다. 라우터는 데이터의 목적지 MAC주소를 보고 자신에게 온 데이터인걸 확인하고 목적지 IP를 확인한다. 그리고 받은 메세지에서 IP주소는 바꾸지 않고 출발지 MAC주소는 라우터의 MAC주소, 목적지 MAC주소는 짱구의 MAC주소를 적고 스위치로 전송한다. 마지막으로 스위치는 해당 데이터를 짱구에게 전송하고 짱구는 데이터를 수신한다. 네트워크 계층은 이렇게 다른 LAN영역을 연결하기 위해서 논리적인 주소인 IP주소를 만들어 라우터라는 장치를 이용하는 계층이다. 실제 데이터 전송은 데이터링크 계층, 즉 MAC주소로 하는 것은 달라진 것이 없지만 데이터링크의 한계를 극복하게 해 줬다. 라우터를 넘어가지 않는 영역을 LAN영역이라고 부르고 라우터를 넘어가는 영역을 WAN영역이라 부른다. 네트워크 계층에서는 IP주소와 라우터를 이용해 더 큰 네트워크로 확장하는 방법과 여기서 생긴 문제를 해결하는 프로토콜을 알아보자.
