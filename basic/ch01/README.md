> 이 포스트는 [감자](https://www.inflearn.com/course/%EA%B7%B8%EB%A6%BC%EC%9C%BC%EB%A1%9C-%EC%89%BD%EA%B2%8C-%EB%B0%B0%EC%9A%B0%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC# '감자')님의 강의를 참조하여 작성하였습니다.

## 물리 계층과 데이터링크 계층

우리가 미국에 데이터를 보낸다는 것은 물리적인 무언가를 보낸다는 것이다. 여기서 물리적인 무언가는 어떤 것일까?

> 🙋🏻 전기신호가 아닌가요?

정확하다! 전기신호로 보낼 수 있다. 하지만 이게 전부는 아니다. 전자기파로도 보낼 수 있다. 일반적으로 전기신호는 케이블을 이용해 보낸다. 전압을 측정해서 전압이 낮으면 0, 높으면 1로 해석한다.

> 🙋🏻 전기는 에너지가 아닌가요? 신호를 보내는 방식이라는 게 좀 이상해요!

전기는 에너지이기도 하지만 그 자체로 신호이다. 전기의 투입은 에너지 투입과 동시에 신호의 투입이라고 말할 수 있다. 그럼 전자기파는 무엇일까?

> 🙋🏻 전파 같은 게 아닌가요? 무전기 같은 것들이 이용하는 기술 같은데요.

맞다! 전파는 전자기파의 일종이다. 전자기파는 진동수, 즉 주파수에 따라 구분하는데 우리가 보는 빛이라는 것은 가시광선이다. 우리가 전파라고 말하는 것은 우리가 보지 못하는 영역의 주파수 대역대로 전자기파의 일종이다. 전자기파를 이용하는 통신은 가시광선을 이용하는 광섬유, 즉 유선통신이 있고 전파를 이용하는 무선통신이 있다. 이렇듯 어떠한 신호를 전송하기 위해서는 물리적인 무언가가 필수이다. 이런 것들은 수학, 물리학, 전자공학들의 여러 학문 덕분에 가능해진 것이다. 전기신호와 전자기파 신호 같은 물리적인 신호를 아날로그 신호라고 부르는데 전자기기가 처리하기 위해선 디지털 신호로 바꿔줘야 한다. 물리계층은 디지털 신호를 아날로그 신호로 바꾸고 목적지까지 아날로그 신호를 전달한다. 그리고 목적지에선 받은 아날로그 신호를 다시 디지털 신호로 바꾸는 처리를 한다.

다음으로 데이터링크 계층을 살펴보자. 데이터링크 계층은 같은 네트워크에서 목적지를 구분하는 계층이다. MAC 주소를 이용해 연결된 컴퓨터를 구분하고 정확히 전송이 가능하다. 데이터링크 계층은 물리 계층과 아주 밀접한 관계가 있는 계층으로 정확히 분리하기 힘든 경우도 있다. 대표적으로 랜카드를 설명하는 경우가 그렇다.

> 이 포스트는 [감자](https://www.inflearn.com/course/%EA%B7%B8%EB%A6%BC%EC%9C%BC%EB%A1%9C-%EC%89%BD%EA%B2%8C-%EB%B0%B0%EC%9A%B0%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC# '감자')님의 강의를 참조하여 작성하였습니다.

## 케이블

2대 이상의 컴퓨터가 서로 통신하려면 서로 연결하는 케이블이나 전파가 있어야 한다. 물리적으로 데이터를 전송하는 매체라 물리계층에 해당한다. 이번 포스트엔 서로를 연결하는 케이블에 대해서 알아보자. 케이블은 크게 3가지로 나뉜다. 첫 번째는 UTP 케이블, 두 번째는 동축 케이블, 세 번째는 광 케이블이 있다.

### UTP 케이블

UTP 케이블은 흔히 랜선이라고 부르는 우리 주변에서 흔히 볼 수 있는 케이블이다. 우리의 데스크톱이나 노트북에 유선 인터넷을 연결하는 경우 대부분 UTP 케이블을 사용한다. UTP 케이블은 Unshielded Twisted Pair의 약자이다. 쉴드로 감싸지 않은 꼬인 구리선의 쌍이라는 뜻이다. 총 4개의 쌍에서 1개의 쌍은 송신용, 1개의 쌍은 수신용으로 사용했지만 더 빠른 속도를 내기 위해서 나머지 쌍도 송신용, 수신용으로 사용한다. 총 2개의 쌍은 송신용, 2개의 쌍은 수신용인 것이다. 송수신용이 따로 구분되었기 때문에 전이중 통신이 가능한 케이블이다. UTP 케이블은 가격이 싸고 성능이 좋고 배선하기 편하다는 장점이 있다.

### 동축 케이블

동축 케이블은 중앙에 데이터를 전송하는 구리선을 감싼 케이블이다. 자기장 간섭이 적어서 UTP 케이블보다 더 멀리 전송할 수 있다. 하지만 선이 1개이기 때문에 반이중 통신만 가능하다. 예전에 랜카드에 동축 케이블을 연결하는 BNC 단자가 존재했지만 이제는 보기 힘들다. 하지만 중국이나 유럽에서는 아직 많이 사용한다. 우리나라에서는 LAN용으로 사용되지는 않고 TV나 안테나에 사용돼서 안테나 선이라고 부른다. UTP 케이블보다는 설치하기 어렵고 비싸다는 단점이 있다.

### 광 케이블

광 케이블은 유리나 플라스틱으로 만들어진 케이블로 빛을 이용한 케이블이다. 빛을 이용하기 때문에 외부간섭이 없어 전기를 이용하는 것보다 더 많이 더 빨리 전송할 수 있다. (전기는 데이터를 빨리 보내려면 왜곡이 생기므로 전송속도 한계가 있지만 빛은 없다.) 하지만 구부림에 약하고 전기신호를 빛 신호로, 빛 신호를 전기 신호로 바꾸는 트랜시버가 필요하다는 단점이 존재한다.

> 이 포스트는 [감자](https://www.inflearn.com/course/%EA%B7%B8%EB%A6%BC%EC%9C%BC%EB%A1%9C-%EC%89%BD%EA%B2%8C-%EB%B0%B0%EC%9A%B0%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC# '감자')님의 강의를 참조하여 작성하였습니다.

## 랜카드

이번 포스트에서 알아볼 장치는 랜카드이다. 랜카드는 Network Interface Card로 불리는 하드웨어로 데이터링크 계층에 해당하는 장치이다. (물리 계층 기능도 수행) 우리의 컴퓨터 메인보드에 내장되어 있거나 추가 슬롯에 연결해 사용한다. 랜카드는 애플리케이션 계층부터 시작해서 각 계층을 타고 내려온 최종 디지털 데이터인 프레임을 아날로그 데이터로 바꾸기도 하고 우리에게 전달되는 아날로그 데이터를 디지털 데이터로 바꾸기도 한다. 랜카드는 고유의 주소를 나타내는 MAC 주소라는 것을 가지고 있는데 MAC 주소는 다음 포스트에 자세히 다뤄보고 지금은 전 세계에서 유일한 주소라는 것만 알아두자. 케이블을 타고 아날로그 데이터가 랜카드에 전달되면 랜카드는 아날로그 데이터를 디지털 데이터로 변환한다. 무선 랜카드는 전파를 통해 전송되는 아날로그 데이터를 디지털 데이터로 변환한다. 그리고 디지털 데이터에서 데이터 링크 헤더에 적힌 목적지 MAC 주소가 자신의 MAC 주소와 일치하는지 비교한다. 일치하면 CPU에게 데이터가 왔다고 알려주고 일치하지 않는다면 버린다. 랜카드는 아날로그 데이터를 디지털 데이터로 바꿔주고 필요한 데이터만 정확히 받는 아주 중요한 장치이다.

> 이 포스트는 [감자](https://www.inflearn.com/course/%EA%B7%B8%EB%A6%BC%EC%9C%BC%EB%A1%9C-%EC%89%BD%EA%B2%8C-%EB%B0%B0%EC%9A%B0%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC# '감자')님의 강의를 참조하여 작성하였습니다.

## MAC 주소

이전 포스트에 랜카드를 배우면서 MAC 주소라는 것을 알게 되었다. MAC 주소는 데이터링크 계층에서 사용되는 기술이고 랜카드가 데이터링크 계층인 이유도 바로 MAC 주소 때문이다. MAC 주소는 Media Access Control 주소의 약자이다. 각각의 기기를 구분하기 위한 용도로 만들어졌고 기기가 만들어질 때 제조사에서 고유한 MAC 주소를 부여한다.

> 🙋🏻 제조사에서 실수로 겹치게 MAC주소를 만들면 어떻게 될까요?

제조사 간에 MAC주소가 겹칠 일은 없다. MAC 주소는 미국의 전기전자공학자협회에서 관리한다. MAC 주소는 48bit, 즉 6byte로 구성된다. 전기전자공학자협회는 제조사를 구분할 수 있도록 MAC 주소의 앞 24bit에 제조사 코드를 부여한다. 그럼 제조사들은 MAC 주소 앞 24bit를 전기전자공학자협회로부터 부여받은 값을 사용하고 나머지 24bit를 기기 고유의 값으로 사용한다. 이런 이유로 MAC 주소를 알면 제조사를 알아낼 수 있다.

한번 나의 MAC주소와 제조사를 확인해 보자. 먼저 터미널을 열고 아래의 명령어를 입력한다.

```
ifconfig | egrep "(^\\w|ether)"
```

MAC 주소가 확인 될 것이다. 이 MAC 주소의 제조사를 알아보자. 웹 브라우저에 [https://uic.io/ko/mac/](https://uic.io/ko/mac/)를 입력해보자.  그러면 제조사를 확인할 수 있을 것이다. MAC 주소는 이렇게 우리의 유무선 랜카드뿐만 아니라 공유기(라우터) 스위치에 할당되어서 기기를 구분하는 역할을 한다.

> 이 포스트는 [감자](https://www.inflearn.com/course/%EA%B7%B8%EB%A6%BC%EC%9C%BC%EB%A1%9C-%EC%89%BD%EA%B2%8C-%EB%B0%B0%EC%9A%B0%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC# '감자')님의 강의를 참조하여 작성하였습니다.

## \[네트워크 구성\] 최초의 통신

우리는 랜카드와 케이블을 배웠으니 이제 네트워크를 구성할 수 있다. 컴퓨터 2대를 연결해 보겠다. 각 컴퓨터의 본체에는 메인보드에 랜카드가 탑재되어 있다. 그리고 UDP 케이블을 이용해 랜카드에 연결했다. 두 컴퓨터가 통신하기 위해서는 같은 네트워크 대역의 IP로 설정해줘야 하는데 아직 IP를 배우지 않았으니 일단 넘어가자. 이제 통신할 준비는 끝이 났다. 하나의 컴퓨터는 웹 클라이언트로, 다른 컴퓨터는 웹 서버로 가정하자. 먼저 클라이언트의 웹 브라우저에 서버의 IP 주소를 입력하고 Enter를 누르면 애플리케이션 계층, 트랜스포트 계층, 네트워크 계층, 데이터링크 계층을 거쳐서 프레임이 만들어진다. 프레임은 0과 1로 이루어진 디지털 데이터이다. 여기서 이 프레임은 Network Interface Card, 즉 랜카드가 처리한다. 디지털 데이터인 프레임을 아날로그 신호로 바꿔서 케이블로 연결된 서버 컴퓨터의 랜카드로 전송한다. 서버 컴퓨터의 랜카드는 수신한 아날로그 데이터를 다시 디지털 데이터로 바꿔서 프레임을 복구하고 이 프레임을 분해해서 클라이언트의 요청에 맞는 처리를 하고 다시 클라이언트에게 응답을 보내준다. 그럼 클라이언트는 웹 브라우저를 통해서 서버의 웹 사이트를 볼 수 있는 것이다.

좀 더 자세히 보면 이렇다. 클라이언트 컴퓨터로 웹 브라우저에 서버의 IP 주소를 입력하면 먼저 클라이언트는 연결확립을 하기 위해 연결 확립 메세지를 보낸다.. 이후에 연결 확립 완료가 되면 연결 확립 완료 메시지를 보내고 본 데이터를 요청한다. 그러면 서버 측에서는 응답 메시지를 보낸다. 이후에 클라이언트는 연결 끊기 메시지를 보내며 통신을 종료시킨다.

> 🙋🏻 그런데 왜 이런 연결과정이 필요한건가요?

실제로 HTTP 요청을 하게 되면 TCP에 의해서 본 데이터를 보내기 전에 연결을 확립하는 과정이 추가된다. 따라서 본 데이터를 보내기 전에 연결을 확립하는 과정까지 나오는데 일단은 데이터가 어떻게 이동하는지 큰 흐름만 먼저 확인하자.

> 🙋🏻 그런데 네트워크라고 하면 많은 장비와 용어가 있던데 이게 끝인가요?

우리는 2대의 컴퓨터가 통신하는 최소 단위의 네트워크를 알아봤고 더 큰 네트워크는 아직 알아보지 않았다.

> 이 포스트는 [감자](https://www.inflearn.com/course/%EA%B7%B8%EB%A6%BC%EC%9C%BC%EB%A1%9C-%EC%89%BD%EA%B2%8C-%EB%B0%B0%EC%9A%B0%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC# '감자')님의 강의를 참조하여 작성하였습니다.

## 리피터

컴퓨터의 역사를 보면 운영체제와 네트워크가 어떻게 발전했는지 알 수 있다. 값 비싼 CPU를 더 활용하기 위해서 시분할, 다중 사용자가 지원되는 운영체제로 발전했다. 이렇게 컴퓨터의 성능이 좋아져 활용 능력이 커졌지만 조금 아쉬운 문제가 발생한다. 물리적으로 떨어진 다른 컴퓨터로 데이터를 이동시키고 싶지만 그게 안 된다는 점이다. 케이블이 없다면 저장매체에 데이터를 저장하고 다른 컴퓨터까지 직접 걸어가서 저장매체를 이용해 데이터를 옮겨야 한다. 요즘 같으면 USB 메모리를 이용할 수도 있겠지만 예전에는 플로피 디스크를 이용했다. 즉, 케이블이 없다면 저장장치에 저장해서 다른 컴퓨터로 들고 가야 한다는 단점이 있다는 것이다. 이전 포스트에 알아본 것처럼 두 컴퓨터가 케이블로 연결되어 있다면 언제든지 데이터를 전송할 수 있다. 저장장치도 필요 없고 걸어갈 필요도 없어서 굉장히 편안할 것이다. 여기서 사용자는 욕심이 생기기 시작한다. 같은 방에 있는 두 컴퓨터가 통신이 가능해졌으니 이 컴퓨터를 더 멀리 떨어트리고 싶은 것이다. 그래서 컴퓨터 하나를 다른 건물로 이동시키고 이 둘을 케이블로 연결해서 데이터를 전송하려고 했지만 통신이 제대로 이루어지지 않는다.

> 🙋🏻 왜 그래요? 연결된 것은 같은데 거리만 멀어졌는데요?

달라진 것은 거리 밖에 없다. 바로 거리가 통신이 이루어지지 않는 요인이 된다. 왜 그럴까? PC1에서 PC2로 데이터를 전송한다면 PC1의 랜카드에서 디지털 신호가 아날로그 신호로 변환된다. PC2의 랜카드는 아날로그 신호를 어떻게 디지털 신호로 바꿀까? UTP 케이블이라 전기로 신호가 온다고 가정하고 이 아날로그 신호의 가장 낮은 전압 0V, 가잔 높은 전압을 5V라고 가정하자. 전압을 보고 2V아래면 디지털 신호 0으로 변환하고 4V위면 디지털 신호 1로 변환한다. 거리가 가까울 때는 문제가 되지 않는다. 왜냐하면 아날로그 신호에 왜곡이 적기 때문이다. 하지만 거리가 멀어진다면 아날로그 신호가 약해지고 잡음이 섞여서 원래 신호가 왜곡된다. 즉, 원래 데이터를 잃어버리는 것이다. 이렇듯 거리가 멀어진다면 물리적인 한계로 통신을 제대로 할 수 없다.

> 🙋🏻 그러면 어떻해요?

그래서 리피터라는 것이 등장하였다. 영어로 repeat은 "반복하다"라는 뜻이다. repeater는 반복해 주는 거라는 의미이다. 그럼 무엇을 반복할까? 바로 신호이다. 거리가 더 멀어져 신호가 완전히 망가지기 전에 중간에서 조금 왜곡된 신호를 다시 원래 신호로 복원하고 약해진 신호를 증폭해 주는 역할을 한다. 단순히 물리적인 신호를 다시 물리적인 신호로 증폭하기 때문에 물리 계층에 해당하는 장치이다. UTP 케이블은 보통 100m까지 에러 없이 사용가능하니까 다른 PC와 연결할 때 100m마다 리피터를 설치해 주면 문제없이 통신 가능하다.

> 🙋🏻 그러면 한국에서 미국까지 통신이 가능할까요?

이론적으로는 가능하다. 다만 리피터를 많이 필요할 것이고 비용이 매우 비쌀 것이다.

> 이 포스트는 [감자](https://www.inflearn.com/course/%EA%B7%B8%EB%A6%BC%EC%9C%BC%EB%A1%9C-%EC%89%BD%EA%B2%8C-%EB%B0%B0%EC%9A%B0%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC# '감자')님의 강의를 참조하여 작성하였습니다.

## 허브

이전 포스트에는 2대의 컴퓨터를 케이블로 연결해 통신하면서 거리가 멀어질 때 리피터라는 장치로 문제를 해결했다. 이렇게 2대의 컴퓨터는 거리가 조금 멀리 떨어져 있어도 통신할 수 있다. 여기서 연구실에 더 많은 사람이 들어오게 되고 더 많은 컴퓨터를 구매하게 되었다. 모두가 연구자료를 공유하기 위해선 전부 케이블로 연결되어야 하는데 컴퓨터에는 랜카드 하나밖에 없기 때문에 하나의 랜선만 연결이 가능하다. 여기서 연구자 1명이 아이디어를 냈다.

> 💡 컴퓨터 하나를 더 연결하려면 랜카드 하나를 더 설치하면 되는 게 아닐까?

직관적으로 생각할 수 있는 방법이다. PC1과 PC3을 연결하기 위해서 각 PC에 랜카드를 추가로 설치하고 랜선으로 연결하면 된다. 만약 PC1과 PC4를 연결하고 싶다면 각 PC에 랜카드를 추가적으로 또 설치하고 랜선으로 연결하면 된다. 그런데 이 방법은 앞으로 컴퓨터 몇 대를 더 연결할지도 모르는데 컴퓨터 1대당 랜카드 하나씩 둔다면 확장성에 큰 문제가 생길 것이 뻔하다. 그러면 어떻게 할까? 이런 문제점 때문에 등장한 장치가 허브이다.

먼저 허브의 뜻부터 보자. 허버의 뜻을 찾아보면 중심이라는 뜻이라는 것을 알 수 있다. 네트워크에서의 허브도 똑같은 의미로 쓰인다. 허버는 여러대의 컴퓨터를 연결하는 중심이 되는 장치이다. 컴퓨터는 서로 통신하기 위해서 직접 케이블로 연결하는 것이 아니라 중간에 있는 허브에 케이블로 연결한다. 허브에는 랜선을 꽂을 포트가 있다. 보통 5개가 있어서 5 포트 허브라고 불린다. 4대의 컴퓨터가 통신을 위해서 허브에 연결한 상황이라고 보자. PC1이 PC4에게 데이터 전송하고 싶다면 목적지 MAC 주소를 PC4로 설정하고 연결된 허브로 데이터를 보낸다. 데이터를 수신한 허브는 수신한 포트를 제외한 나머지 포트로 이 데이터를 전송한다. 즉, 브로드캐스트 한다. 허브는 이 과정에서 PC1에서 전달되는 약해진 신호를 다시 증폭까지 한다. 즉 리피터 역할을 한다. 이 때문에 허브를 멀티포트 리피터라고 부른다. MAC 주소에 상관없이 단순히 물리신호를 브로드캐스팅하므로 물리계층에 해당하는 장치이다. PC2, PC3, PC4의 랜카드는 허브에서 온 아날로그 신호를 디지털 데이터로 바꾼다. 랜카드는 프레임의 헤더에 적힌 목적지 MAC 주소를 참조해 자신의 MAC 주소와 비교한다. PC2, PC3은 목적지 MAC 주소가 자신의 MAC 주소와 일치하지 않으므로 데이터를 버린다. PC4는 목적지 MAC 주소가 자신의 MAC 주소와 일치하므로 이 데이터를 상위 계층으로 보내 처리한다.

허브의 등장으로 연결할 때마다 랜카드를 추가로 설치 할 필요 없이 여러 대의 컴퓨터가 통신을 할 수 있게 되었다. 그런데 아래 질문이 있다.

> 🙋🏻 그런데 예시로 든 허브는 5포트 허브라서 1대의 PC만 추가적으로 연결이 가능한데 더 많은 PC를 연결하고 싶다면 더 큰 포트의 허브를 사서 연결해야 하나요?

지금 이 5포트 허브로는 하나의 컴퓨터만 더 연결할 수 있다. 위의 질문처럼 더 큰 허브인 10 포트 허브를 사서 다시 연결해도 된다. 그럼 지금까지 쓰던 5 포트는 버리거나 창고로 들어갈 것이다. 우리는 지금 쓰는 5 포트 허브를 유지한 채로 5 포트 허브를 하나 더 구매할 수 있다. 그리고 5 포트 허브끼리 서로 연결하는 것이다. 그럼 8개의 포트가 되는데 여기에 컴퓨터를 연결하면 8대의 컴퓨터가 통신이 가능해질 것이다.

> 🙋🏻 그러면 컴퓨터가 늘어날 때마다 허브를 추가하면 이론적으로 무한대 연결이 가능한가요?

안타깝지만 그럴 수 없다. 만약 PC1이 PC4에게 데이터를 보내기 위해서 허브로 전송했다면 허브는 브로드캐스팅을 한다. 여기서 PC2가 PC3에게 데이터를 보내기 위해서 허브로 데이터를 전송하면 허브에서 PC2로 오는 데이터와 충돌하게 될 것이다. 그러면 원래 신호가 왜곡되어서 통신할 수 없는 상황이다. 충돌이 발생하지 않도록 PC2는 허브에서 자신으로 전송되는 데이터가 없을 때까지 기다렸다가 허브로 데이터를 보내는데 이를 CSMA/CD라고 한다. CSMA/CD는 이후에 데이터링크 계층에서 자세히 다루므로 지금은 한순간에 하나의 PC만 데이터를 전송한다는 것만 기억하자. 아무튼 허브는 이렇게 구조상의 이유로 충돌이 발생할 수밖에 없고 충돌이 발생할 수 있는 영역을 콜리전 도메인이라고 부른다. 또한 CSMA/CD를 사용해 반이중 통신이 되어버렸는데 만약 PC가 추가될 때마다 허브에 PC를 연결한다면 하나의 콜리전 도메인에 많은 PC가 있게 되고 만약 100대가 연결되면 한 순간에 하나의 PC만 데이터를 전송할 수 있으므로 통신 속도가 매우 느려진다. 이것이 허브의 한계이고 데이터링크 계층에서 배울 브리지, 스위치가 등장하게 된 이유이다.

> 이 포스트는 [감자](https://www.inflearn.com/course/%EA%B7%B8%EB%A6%BC%EC%9C%BC%EB%A1%9C-%EC%89%BD%EA%B2%8C-%EB%B0%B0%EC%9A%B0%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC# '감자')님의 강의를 참조하여 작성하였습니다.

## \[네트워크 구성\] 더 많이!

이번 포스트엔 허브와 리피터를 추가해서 더 많은 컴퓨터와 통신하는 네트워크를 구성해 보자. 같은 방 내부에 허브를 두고 컴퓨터들을 이 허브에 연결하였다. PC1, PC2, PC3, PC4는 각각 허브에 연결한다. PC3은 물리적으로 많이 떨어져 있어서 중간에 리피터를 설치해 줬다. PC1의 IP주소는 192.168.1.1이고 PC2는 192.168.1.2, PC3은 192.168.1.3, PC4는 192.168.1.4이다. 여기서 PC4는 웹서버를 실행해 서버 역할을 하고 있다. PC1에서 웹 브라우저를 열어서 PC4에게 HTTP 요청을 보내면 어떻게 될까? 웹 브라우저에 웹 서버의 IP주소인 192.168.1.4를 입력한다. 그러면 목적지 MAC 주소를 PC4로 설정해 허브로 전송하고 허브는 연결된 모든 PC로 다시 전송한다. PC3과 연결된 리피터는 허브에서 받은 데이터를 그대로 PC3에게 전달한다. PC2와 PC3은 MAC 주소를 확인해 보니 자신에게 온 것이 아니기 때문에 버린다. PC4는 자신에게 온 것이므로 데이터를 수신한다. 서버는 PC1의 요청에 목적지 MAC 주소를 PC1로 설정해 응답을 보낸다. 이것도 마찬가지로 허브를 통해 모든 PC에 전달되지만 PC1 만 수신하고 나머지 PC는 해당 데이터를 버린다.

> 이 포스트는 [감자](https://www.inflearn.com/course/%EA%B7%B8%EB%A6%BC%EC%9C%BC%EB%A1%9C-%EC%89%BD%EA%B2%8C-%EB%B0%B0%EC%9A%B0%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC# '감자')님의 강의를 참조하여 작성하였습니다.

## 이더넷과 이더넷 헤더

이번 포스트부터 데이터링크 계층에 대해 알아보자. 물리 계층에서는 데이터를 단순히 물리적인 신호로 바꿔서 전달만 하는 역할을 했다면 데이터링크 계층에서는 기기에 MAC 주소라는 것을 부여해 원하는 기기에만 데이터를 전달할 수 있도록 한다.(이 외에도 매체공유, 비공유 기술, 스위칭등을 하며 실제 전송은 물리계층에 의존한다.) 현재 데이터링크 계층에서 가장 많이 사용하고 있는 프로토콜은 이더넷이다. (Token, Ring, FDDI 등도 존재)

이더넷은 구조가 간단하고 장비가 저렴해서 데이터링크 계층을 대표한다. 초기 이더넷은 동축 케이블을 이용해 통신했다. IEEE 802.3 위원회에 의해서 상세하게 만들어졌는데 문서를 보면 동축 케이블을 어떻게 만들어야 하고 처리해야 하는지 상세하게 나와있다. 초기 이더넷은 동축 케이블을 사용하는 버스형 토폴로지였다. 이런 구조는 송수신을 동시에 하면 충돌이 발생하기 때문에 CSMA/CD라는 프로토콜이 만들어졌고 반이중 통신으로 안전하게 통신할 수 있었다. 하지만 반이중 통신은 속도에 한계가 있었고 이를 해결하기 위해서 UTP 케이블과 광 케이블이 등장하였다. IEEE 802.3 위원회는 전송속도와 케이블에 따라서 다시 세분화되는데 종류는 여러 가지가 더 있었다. 케이블 제조업체들은 케이블을 만들 때 IEEE 802.3을 참조해서 상세 스펙을 맞춰서 만들게 되고 이것을 표준을 지킨 케이블이라고 말한다. 덕분에 우리는 제조업체에 신경 쓰지 않고 케이블만 구매해 통신을 할 수 있는 것이다. 이전에 TCP/IP와 OSI 7 계층을 설명하는 포스트에서 데이터링크 계층은 네트워크 계층에서 전달되는 패킷에 데이터링크의 약속을 나타내는 헤더를 덧붙인다고 말했다. 그럼 헤더가 어떻게 생겼는지 자세히 보자.

헤더는 IEEE 802.3에서 정의했는데 쉽게 표현하면 아래와 같다.

> Preamble -> SFD -> Destination Address -> Source Address -> Length/Type -> Data(Pad) -> FCS

데이터는 왼쪽부터 오른쪽으로 전송된다. (송신측은 왼쪽부터 보내고, 수신 측은 왼쪽부터 받는다.) 여기서 Data 필드는 네트워크 계층에서 전달된 데이터, 즉 패킷을 말한다. Destination Address에서 Length/Type 필드까지를 이더넷 헤더라고 부르고 FCS는 이더넷 트레일러라고 부른다. 그리고 이더넷 헤더와 이더넷 트레일러가 붙은 전체의 데이터를 프레임이라고 부른다.

그럼 각 필드는 어떤 의미인지 알아보자. 가정 먼저 Preamble과 SFD(Start Frame Delimiter)라는 필드가 존재한다. 이 필드는 랜카드에게 이더넷 프레임이 시작된다는 것을 알리는 역할을 한다. 총 8byte, 즉 64bit로 구성되어 있다. 그다음으로 수신처 MAC주소와 송신처 MAC 주소가 나온다. 각각 6byte, 즉 48bit로 구성되어 있다. 만약 수신처의 MAC주소가 모두 1(FF-FF-FF-FF-FF-FF)로 되어 있다면 이 데이터를 브로드캐스트 하라는 뜻이다. Length/Type 필드에는 상위계층의 프로토콜 타입이나 현재 프레임의 데이터의 길이가 저장되어 있다. 2byte로 구성되어 있는데 이 값이 1500 이하면 데이터의 길이를, 1500보다 크다면 상위 프로토콜의 타입을 나타낸다. Data 필드는 46~1500byte까지 올 수 있고 네트워크 계층에서 전달받은 패킷을 나타낸다. 데이터의 크기가 너무 작다면 PAD 필드에 데이터를 덧붙여서 적절한 크기로 만든다. 마지막으로 FCS(Frame Check Sequence) 필드는 이 프레임이 손상되었는지 체크하기 위한 필드이다. 4byte 크기이며 수신 측에는 FCS를 체크해서 데이터가 손상되었는지 판단하고 이 프레임 전체를 버린다. 이더넷 프레임의 크기는 Data 필드에 따라서 64~1518byte가 된다.
